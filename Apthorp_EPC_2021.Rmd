---
title: "Running studies online"
subtitle: "Tips, tools and lessons learnt"
author: "Deborah Apthorp"
institute: "University of New England"
date: "April 11th, 2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css:
      - default
      - rladies
      - rladies-fonts
      - css/rladies-mod.css
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: 4:3
---
```{r load and analyse data, include = FALSE}
library(readr) # for reading in csv files 
library(dplyr) # for wrangling data
library(here)  # for simplifying file paths
library(tidyverse) # for making everything tidy
library(mosaic)
library(tableone)
library(forcats)
library(corrplot)
library(Hmisc)
library(tidyverse)
library(palmerpenguins)
library(fontawesome)

# preset code chunk options
knitr::opts_chunk$set(dpi = 300,            # ensures high resolution images
                      echo = FALSE,         # FALSE: code chunks don't show
                      warning = FALSE,      # FALSE: suppresses warning messages
                      error = FALSE)        # FALSE: Suppresses error messages

## Wrangle 2018 data
Data_2018 <- readRDS(here( "Data_2018.rds")) # Read in Qualtrics file saved as SPSS .sav file
level_key_yes_no <- c("1" = "Yes", "0" = "No")
Data_2018$completed_FT <- as_factor(Data_2018$completed_FT)
Data_2018$completed_PVT <- as_factor(Data_2018$completed_PVT)
Data_2018$completed_TS <- as_factor(Data_2018$completed_TS)
Data_2018$completed_Nback <- as_factor(Data_2018$completed_Nback)
Data_2018$completed_FT <-recode(Data_2018$completed_FT, !!!level_key_yes_no)
Data_2018$completed_PVT <- recode(Data_2018$completed_PVT, !!!level_key_yes_no)
Data_2018$completed_TS <- recode(Data_2018$completed_TS, !!!level_key_yes_no)
Data_2018$completed_Nback <- recode(Data_2018$completed_Nback, !!!level_key_yes_no)

Data_2018$computerplatform[Data_2018$computerplatform == ""] <- "unknown" 

Descriptive_subset_sample_2018<-Data_2018 %>%
  select(Age, Gender, completed_FT, completed_PVT, completed_TS, completed_Nback)
Descriptive_subset_sample_2018$Gender <- as_factor(Descriptive_subset_sample_2018$Gender)

level_key_gender <- c("1" = "Female", "2" = "Male", "3" = "Other")
Descriptive_subset_sample_2018$Gender <-recode(Descriptive_subset_sample_2018$Gender, !!!level_key_gender)

Descriptive_subset_survey_2018<-Data_2018 %>%
 select(completed_FT, AQ10_score, ME_score, AUDIT_ALC, DASS_Depression, DASS_Anxiety, DASS_Stress, PSQI_Global, Dream_recall)

SurveyVars<-c("AQ10_score", "ME_score", "AUDIT_ALC","DASS_Depression", "DASS_Anxiety",  "DASS_Stress", "PSQI_Global", "Dream_recall")

b <-print(CreateTableOne(vars=SurveyVars, strata= "completed_FT", data=Descriptive_subset_survey_2018))

Descriptive_subset_behavioural_2018<-Data_2018 %>%
 select(computerplatform, PVT_meanRT500, TS_RT_SwitchCost, nBack_dprime, FT_score_dominant, FT_score_nondominant)

Descriptive_subset_behavioural_2018 <- filter(Descriptive_subset_behavioural_2018, Descriptive_subset_behavioural_2018$computerplatform !='unknown') # filter out unknown computer platforms

BehaviouralVars<-c("PVT_meanRT500", "TS_RT_SwitchCost", "nBack_dprime", "FT_score_dominant", "FT_score_nondominant")

# Make list of the variable labels you want to use for each variable
var_label_list <- list(PVT_meanRT500 = "PVT reaction time", 
                       TS_RT_SwitchCost = "Task Switching RT cost",
                       nBack_dprime = "n-Back d prime",
                       FT_score_dominant = "FTT score (dom)",
                       FT_score_nondominant = "FTT score (non-dom)")

#attach/assign the labels to the variables in the data
labelled::var_label(Descriptive_subset_behavioural_2018) <- var_label_list

c <-print(CreateTableOne(vars=BehaviouralVars, strata= "computerplatform", data=Descriptive_subset_behavioural_2018), varLabels = TRUE)

as.data.frame(c)

tab_sample <- CreateTableOne(data=Descriptive_subset_sample_2018)

a <- print(tab_sample, quote = FALSE, noSpaces = TRUE)

as.data.frame(a)

tab_survey <- CreateTableOne(data=Descriptive_subset_survey_2018, strata= "completed_FT")

as.data.frame(b)

Data_2019 <- readRDS(here( "Data_2019.rds")) 

Data_2019$completed_FT <- !is.na(Data_2019$FTT_groupid)
Data_2019$completed_PVT <- !is.na(Data_2019$PVT_groupid)
Data_2019$completed_IGT <- !is.na(Data_2019$IGT_groupnumber)

Data_2019$FTT_computer.platform[Data_2019$FTT_computer.platform == ""] <- "unknown" 
Data_2019$PVT_computer.platform[Data_2019$PVT_computer.platform == ""] <- "unknown"
Data_2019$computer.platform[Data_2019$computer.platform == ""] <- "unknown" 

Descriptive_subset_sample_2019<-Data_2019 %>%
  select(Age, Gender, completed_FT, completed_PVT, completed_IGT)
Descriptive_subset_sample_2019$Gender <- as_factor(Descriptive_subset_sample_2019$Gender)

Descriptive_subset_sample_2019$Gender <- recode(Descriptive_subset_sample_2019$Gender, !!!level_key_gender)

Descriptive_subset_survey_2019<-Data_2019 %>%
 select(completed_FT, AQ_total, ME_score, AUDIT_ALC, DASS_Depression, DASS_Anxiety, DASS_Stress, PSQI_Global)

SurveyVars_2019<-c("AQ_total", "ME_score", "AUDIT_ALC","DASS_Depression", "DASS_Anxiety",  "DASS_Stress", "PSQI_Global")

b_2019 <-print(CreateTableOne(vars=SurveyVars_2019, strata= "completed_FT", data=Descriptive_subset_survey_2019))

as.data.frame(b_2019)

Descriptive_subset_behavioural_2019<-Data_2019 %>%
 select(computer.platform, PVT_meanRT500, IGT_expressions.NET, FTT_score_dominant, FTT_score_nondominant)

Descriptive_subset_behavioural_2019 <- filter(Descriptive_subset_behavioural_2019, Descriptive_subset_behavioural_2019$computer.platform !='unknown') # filter out unknown computer platforms

BehaviouralVars_2019<-c("PVT_meanRT500", "FTT_score_dominant", "FTT_score_nondominant", "IGT_expressions.NET")

# Make list of the variable labels you want to use for each variable
var_label_list_2019 <- list(PVT_meanRT500 = "PVT reaction time",
                       IGT_expressions.NET = "IGT net score",
                       FTT_score_dominant = "FTT score (dom)",
                       FTT_score_nondominant = "FTT score (non-dom)")

#attach/assign the labels to the variables in the data
labelled::var_label(Descriptive_subset_behavioural_2019) <- var_label_list_2019

f <-print(CreateTableOne(vars=BehaviouralVars_2019, strata= "computer.platform", data=Descriptive_subset_behavioural_2019), varLabels = TRUE)

as.data.frame(f)

tab_sample_2019 <- CreateTableOne(data=Descriptive_subset_sample_2019)

a_2019 <- print(tab_sample_2019, quote = FALSE, noSpaces = TRUE)

as.data.frame(a_2019)


```

class: title-slide, center, middle, inverse
background-image: url(img/PurpleSky.jpg)
background-position: bottom
background-size: cover

# `r rmarkdown::metadata$title`
## `r rmarkdown::metadata$subtitle`
## `r rmarkdown::metadata$author`
## `r rmarkdown::metadata$institute`
### `r rmarkdown::metadata$date`

Photo by [Vincentiu Solomon](https://unsplash.com/@vincentiu)

???
This slide uses:
- a custom `title-slide` class that removes the slide number from the title slide
- a background image
  - background-image: url(img/PurpleSky.jpg)
  - background-position: bottom
  - background-size: cover

---
class: inverse, middle, center

background-image: url(https://media.giphy.com/media/26gs78HRO8sOuhTkQ/giphy.gif)
background-size: contain
class: center, middle, inverse

# Moving to an online university
## UNE 2018




???
This slide uses:
- the `inverse`, `middle`, and `center` slide classes
- an image inserted with html

---

class: inverse, center, middle
background-image: url(https://media.giphy.com/media/1msv9p84BukVq63l4R/giphy.gif)
background-size: contain
# Getting Started

---

???
So, what to do first? 

---
# Structure of the projects

I worked with group projects from 2018-2020

--

5-10 students per group - group data collection, individual questions

--

- Allowed for the possibility of collecting more data than I'd ever had in one place!

--

- Catch - all data collection had to be online

--

- Plan: Combine survey data with online behavioural experiments

--

- Overall theme: Sleep, Memory and Attention

--

- Individual questions (examples): 

--

  - Do people with higher visual working memory remember their dreams more? 

--

  - Is "chronotype" related to executive function?
 
--

  - Are autism spectrum characteristics related to motor control in the general population?
  
???
This slide uses:
- bullet list with `*`
- incremental slides divided by `--`
- numbered list with `1.`
- a horizontal bar
- the `.footnote[]` class

---
# Inserting images

```{r, echo = TRUE, fig.alt="World map with countries that have R-Ladies chapters highlighted in purple"}
knitr::include_graphics("img/RLadiesMap.png")
```

--

> Note: You can use the `fig.alt` code chunk option to add alternative text to your images, that way they are accessible to screen reader users:
- In code chunk: `{r, fig.alt = "<descriptive alt text>"}`.
- Read more about this in [{knitr} NEWS.md](https://github.com/yihui/knitr/blob/master/NEWS.md#new-features-1)

???
This slide uses:
- an image inserted with `knitr::include_graphics()`
- the `fig.alt =` code chunk option for alternative text

---
# Tables and quotes

### Table

.pull-left[

`palmerpenguins::penguins`

The `penguins` dataset contains size measurements for adult penguins nesting near Palmer Station in Antarctica.

Measurements like `body_mass_g`
]

.pull-right[

```{r}
palmerpenguins::penguins %>%
  select(species, island, body_mass_g) %>%
  arrange(body_mass_g) %>%
  head() %>%
  knitr::kable(format = 'html')
```
]

???
This slide uses:
- the `.pull-left[]` and `.pull-right[]` classes
- an R code chunk to produce the html table

--

### Quote

> You can read more about the `palmerpenguins` data package authored and maintained by Allison Horst at [allisonhorst.github.io/palmerpenguins](https://allisonhorst.github.io/palmerpenguins/)

???
- a quote with `>`

---
# Highlighting code

`> This is what inline code looks like`

You can highlight lines of code within code chunks using `#<<`:

### Code

```r
palmerpenguins::penguins %>%
  ggplot(aes(x = island, y = body_mass_g)) +
  geom_boxplot(aes(fill = island))               #<<
```

### Output

```{r eval=FALSE, echo=TRUE}
palmerpenguins::penguins %>%
  ggplot(aes(x = species, y = body_mass_g)) +
  geom_boxplot(aes(fill = island))               #<<
```

???
This slide uses:
- inline code highlighting with backticks ` `` `
- a code chunk to produce a ggplot

---

```{r penguin-body-mass, eval=TRUE, echo=TRUE, fig.height = 4.5}
palmerpenguins::penguins %>%
  ggplot(aes(x = species, y = body_mass_g)) +
  geom_boxplot(aes(fill = island))               
```

???
This slide uses:
- a code chunk to produce a ggplot
- code chunk option `fig.height = 4.5` to control the figure height

---
class: middle, inverse, title-slide

.pull-left[
# Thank you!
<br/>
## R-Ladies Global  

### Promoting gender diversity in the R community
]

.pull-right[
.right[
<img style="border-radius: 50%;"
src="img/RLadiesGlobal.png"
width="150px" />

[rladies.org](https://rladies.org)<br/>
[@RLadiesGlobal](https://twitter.com/rladiesglobal)<br/>
[info@rladies.org](mailto:info@rladies.org)<br>
[Join the Slack](https://rladies-community-slack.herokuapp.com/)
]]

???
Thank you for joining me!
You can find my contact information linked on this slide if you want to get in touch, and I'm happy to take any questions.

This slide also uses:
- the `title-slide` class, to remove the slide number at the bottom :)
